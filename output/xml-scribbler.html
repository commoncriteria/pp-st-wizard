<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta content="text/html;charset=utf-8" http-equiv="Content-Type"></meta>
      <meta content="utf-8" http-equiv="encoding"></meta>

      <title>XML Scratchpad</title>

      <link rel="stylesheet" href="https://codemirror.net/lib/codemirror.css"></link>
      <link rel="stylesheet" href="https://codemirror.net/doc/docs.css"></link>
      <link rel="stylesheet" href="https://codemirror.net/addon/hint/show-hint.css"></link>


      <!-- Create a simple CodeMirror instance -->
      <script src="https://codemirror.net/lib/codemirror.js" type="text/javascript"></script>
      <script src="https://codemirror.net/mode/xml/xml.js" type="text/javascript"></script>
      <script src="https://codemirror.net/addon/hint/show-hint.js" type="text/javascript"></script>
      <script src="https://codemirror.net/addon/hint/xml-hint.js"  type="text/javascript"></script>

      <script src="https://syssgx.github.io/xml.js/js/xmllint.js" type="text/javascript"></script>
      <script type="text/javascript"> 
      /* <![CDATA[ */
      var xml_tbox;
      var schema_text = 
         "<grammar xmlns='http://relaxng.org/ns/structure/1.0'>\
   <start>\
      <element name='book'>\
         <oneOrMore>\
            <ref name='page'/>\
         </oneOrMore>\
      </element>\
   </start>\
   <define name='page'>\
      <element name='page'>\
         <text/>\
      </element>\
   </define>\
</grammar>";
      function handleOnLoad(){
          var xml_input = document.getElementById('xml_input');

          if (typeof(Storage) !== "undefined") {
             alert("We have storage.");// Code for localStorage/sessionStorage.
          }
          else {
             alert("No storage.");  // Sorry! No Web Storage support..
          }
          xml_tbox = CodeMirror.fromTextArea(xml_input, {
	         lineNumbers: true,
	         mode: "xml",
             hintOptions: {schemaInfo: tags},
             extraKeys: {
               "F11": handleValidateClick,
                 "'<'": completeAfter,
               "'/'": completeIfAfterLt,
               "' '": completeIfInTag,
               "'='": completeIfInTag,
               "Ctrl-Space": "autocomplete"
             },
	      });
      }
      function handleValidateClick(){
         var args = {};
	     args.xml=xml_tbox.getValue();
	     args.schema= schema_text;
         args.arguments =["--noout", "--relaxng", "schema", "text"];
         var blah = validateXML(args);
         document.getElementById("output").value = blah;
         console.log(blah);
      }

      var dummy = {
        attrs: {
          color: ["red", "green", "blue", "purple", "white", "black", "yellow"],
          size: ["large", "medium", "small"],
          description: null
        },
        children: []
      };

      var tags = {
        "!top": ["top"],
        "!attrs": {
          id: null,
          class: ["A", "B", "C"]
        },
        top: {
          attrs: {
            lang: ["en", "de", "fr", "nl"],
            freeform: null
          },
          children: ["animal", "plant"]
        },
        animal: {
          attrs: {
            name: null,
            isduck: ["yes", "no"]
          },
          children: ["wings", "feet", "body", "head", "tail"]
        },
        plant: {
          attrs: {name: null},
          children: ["leaves", "stem", "flowers"]
        },
        wings: dummy, feet: dummy, body: dummy, head: dummy, tail: dummy,
        leaves: dummy, stem: dummy, flowers: dummy
      };
      function completeAfter(cm, pred) {
        var cur = cm.getCursor();
        if (!pred || pred()) setTimeout(function() {
          if (!cm.state.completionActive)
            cm.showHint({completeSingle: false});
        }, 100);
        return CodeMirror.Pass;
      }

      function completeIfAfterLt(cm) {
        return completeAfter(cm, function() {
          var cur = cm.getCursor();
          return cm.getRange(CodeMirror.Pos(cur.line, cur.ch - 1), cur) == "<";
        });
      }

      function completeIfInTag(cm) {
        return completeAfter(cm, function() {
          var tok = cm.getTokenAt(cm.getCursor());
          if (tok.type == "string" && (!/['"]/.test(tok.string.charAt(tok.string.length - 1)) || tok.string.length == 1)) return false;
          var inner = CodeMirror.innerMode(cm.getMode(), tok.state).state;
          return inner.tagName;
        });
      }


      /* ]]>*/

    </script>
  </head>
  <body onload="handleOnLoad()">
    <table>
        <tr>
            <td>
               <button onclick="handleValidateClick()">Validate</button>
            </td>
        </tr>
        <tr>
            <td>
                <textarea rows="10" cols="70" id="output"></textarea>  
                <br/>
                <textarea id="xml_input"></textarea>
            </td>
        </tr>
    </table>
  </body>
</html>
<ns0:grammar xmlns:html="http://www.w3.org/1999/xhtml" xmlns:ns0="http://relaxng.org/ns/structure/1.0" xmlns:ns1="http://relaxng.org/ns/compatibility/annotations/1.0" datatypeLibrary="http://www.w3.org/2001/XMLSchema-datatypes" ns="https://niap-ccevs.org/cc/v1">


  <ns0:define name="implements-pat">
    <ns0:optional>
      <ns0:element name="implements">
        <ns1:documentation>
          Maps features to Implementation-dependent requiremetns
        </ns1:documentation>
        <ns0:oneOrMore>
          <ns0:element name="feature">
            <ns0:ref name="id-attr" />
            <ns0:ref name="title-attr" />
            <ns0:ref name="description" />
          </ns0:element>
        </ns0:oneOrMore>
      </ns0:element>
    </ns0:optional>
  </ns0:define>

<ns0:define name="uid">
    <ns0:element name="uid"><ns0:text /></ns0:element>
  </ns0:define>

  <ns0:define name="depends-pat">
    <ns0:zeroOrMore>
      <ns0:element name="depends">
        <ns1:documentation>
          Modifies the parent element such that it depends on something  else.
        </ns1:documentation>
        <ns0:choice>
          <ns0:group>
            <ns0:attribute name="on"><ns0:value>implements</ns0:value></ns0:attribute>
            <ns0:attribute name="ref-id" />
            <ns0:empty />
          </ns0:group>
          <ns0:group>
            <ns0:attribute name="on"><ns0:value>selection</ns0:value></ns0:attribute>
            <ns0:oneOrMore><ns0:ref name="uid" /></ns0:oneOrMore>
          </ns0:group>
        </ns0:choice>
      </ns0:element>
    </ns0:zeroOrMore>
  </ns0:define>

  <ns0:define name="entry-el">
    <ns0:element name="entry">
      <ns1:documentation>
        Wrapper for terms and descriptions.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="id">
          <ns1:documentation>
            Unique ID for this entry so it can be linked. 
            If omitted, it can still be linked with the name or term.
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:choice>
        <ns0:element name="name">
          <ns1:documentation />
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
        <ns0:element name="term">
          <ns1:documentation>
            Thing being defined.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
      </ns0:choice>
      <ns0:element name="description">
        <ns1:documentation>Description of the term/name.</ns1:documentation>
        <ns0:ref name="basic-content-pat" />
      </ns0:element>
    </ns0:element>
  </ns0:define>

  <ns0:define name="acronyms">
    <ns0:element name="acronyms">
      <ns1:documentation>
        Declares where acronyms are visually defined.
      </ns1:documentation>
      <ns0:empty />
    </ns0:element>
  </ns0:define>

  <ns0:define name="id-attr">
    <ns1:documentation>
      Pattern for the id attribute
    </ns1:documentation>
    <ns0:attribute name="id">
      <ns1:documentation>A document-wide unique string.</ns1:documentation>
      <ns0:data type="NCName" />
    </ns0:attribute>
  </ns0:define>

  <ns0:define name="management-function-set">
    <ns0:element name="management-function-set">
      <ns1:documentation>
        Table defining functions that are to be done and what role is required to do them.
      </ns1:documentation>
      <ns0:attribute name="default">
        <ns1:documentation>Is the default value(index).</ns1:documentation>
        <ns0:choice>
          <ns0:value>M</ns0:value>
          <ns0:value>O</ns0:value>
          <ns0:value>_</ns0:value>
        </ns0:choice>
      </ns0:attribute>
      <ns0:oneOrMore>
        <ns0:element name="manager">
          <ns1:documentation>
            Readable role name
          </ns1:documentation>
          <ns0:attribute name="id">
            <ns1:documentation>
              ID unique to this management-function-set. Cross-referenced by the O,M,_ elements
              in the management-function.
            </ns1:documentation>
          </ns0:attribute>
          <ns0:text />
        </ns0:element>
      </ns0:oneOrMore>
      <ns0:oneOrMore>
        <ns0:element name="management-function">
          <ns0:element name="text">
            <ns1:documentation>Describes the management function.</ns1:documentation>
            <ns0:ref name="basic-content-pat" />
          </ns0:element>
          <ns0:zeroOrMore>
            <ns0:choice>
              <ns0:element name="M">
                <ns1:documentation>References for which managers this function is mandatory</ns1:documentation>
                <ns0:attribute name="ref">
                  <ns1:documentation>ID respective manager</ns1:documentation>
                </ns0:attribute>
                <ns0:empty />
              </ns0:element>
              <ns0:element name="O">
                <ns1:documentation>References for which managers this function is optional</ns1:documentation>
                <ns0:attribute name="ref">
                  <ns1:documentation>ID respective manager</ns1:documentation>
                </ns0:attribute>
                <ns0:empty />
              </ns0:element>
              <ns0:element name="_">
                <ns1:documentation>References for which managers this function is not applicable</ns1:documentation>
                <ns0:attribute name="ref">
                  <ns1:documentation>ID respective manager</ns1:documentation>
                </ns0:attribute>
                <ns0:empty />
              </ns0:element>
            </ns0:choice>
          </ns0:zeroOrMore>
        </ns0:element>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>


  <ns0:define name="CClaimsChapter">
    <ns0:element name="chapter">
      <ns1:documentation>
      </ns1:documentation>
      <ns0:attribute name="title"><ns0:value>Conformance Claims</ns0:value></ns0:attribute>
      <ns0:ref name="id-attr" />
      <ns0:optional>
        <ns0:element name="cclaims">
          <ns1:documentation>
          </ns1:documentation>
          <ns0:oneOrMore>
            <ns0:element name="cclaim">
              <ns1:documentation>
              </ns1:documentation>
              <ns0:ref name="title-attr" />
              <ns0:ref name="description" />
            </ns0:element>
          </ns0:oneOrMore>
        </ns0:element>
      </ns0:optional>
    </ns0:element>
  </ns0:define>



  <ns0:define name="f-element-title">
    <ns0:element name="title">
      <ns1:documentation>
        Contains the formal wording for the requirement (either for a-elements or f-elements).
        Must match requirements in CC Part 2 (unless it is an _ext requirement).
      </ns1:documentation>
      <ns0:oneOrMore><ns0:choice>
        <ns0:ref name="basic-content-pat" />
        <ns0:ref name="management-function-set" />
      </ns0:choice></ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="iteration-pat">
    <ns0:optional>
      <ns0:attribute name="iteration">
        <ns1:documentation>
        </ns1:documentation>
        <ns0:data type="string">
          <ns0:param name="pattern">[A-Z0-9_]+</ns0:param>
        </ns0:data>
      </ns0:attribute>
    </ns0:optional>
  </ns0:define>

  <ns0:define name="f-comp-content-pat">
    <ns0:attribute name="id">
      <ns1:documentation>
        The ID without the iteration.
      </ns1:documentation>
      <ns0:ref name="comp-id-respat" />
    </ns0:attribute>
    <ns0:attribute name="name">
      <ns1:documentation>
        Readable title for this requirement.
      </ns1:documentation>
    </ns0:attribute>
    <ns0:ref name="iteration-pat" />
  </ns0:define>

  <ns0:define name="comp-id-upper-respat">
    <ns0:data type="string">
      <ns0:param name="pattern">F[A-Z]{2}_[A-Z0-9^]{2,10}(_EXT)?\.[0-9]</ns0:param>
    </ns0:data>
  </ns0:define>

  <ns0:define name="comp-id-respat">
    <ns0:data type="string">
      <ns0:param name="pattern">f[a-z]{2}_[a-z0-9^]{2,10}(_ext)?\.[0-9]</ns0:param>
    </ns0:data>
  </ns0:define>

  <ns0:define name="fam-id-spat">
     <ns0:data type="string">
       <ns0:param name="pattern">F[A-Z][A-Z]_[A-Z0-9^]{2,10}_EXT</ns0:param>
     </ns0:data>
  </ns0:define>

  <ns0:define name="el-id-spat">
    <ns0:data type="string">
      <ns0:param name="pattern">[\-0-9a-zA-Z]+</ns0:param>
    </ns0:data>
  </ns0:define>

  <ns0:define name="selection-depends">
      <ns0:element name="selection-depends">
        <ns1:documentation>
          Defines the other requirements whose selection affects whether this component must be also applied.
        </ns1:documentation>
        <ns0:attribute name="req">
          <ns1:documentation>
            The value of the id attribute of the requirement is component depends on.
          </ns1:documentation>
          <ns0:ref name="el-id-spat" />
        </ns0:attribute>
        <ns0:attribute name="ids">
          <ns1:documentation>
            A comma delimited list of IDs corresponding to specific "selectable"s which if chosen
            activate this component.
          </ns1:documentation>
        </ns0:attribute>
      </ns0:element>
  </ns0:define>




  <ns0:define name="description">
    <ns0:element name="description">
      <ns1:documentation>
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>


  <ns0:define name="osp-section">
    <ns0:element name="section">
      <ns1:documentation>
        Section describing Organizational Security Policies
      </ns1:documentation>
      <ns0:attribute name="title"><ns0:value>Organizational Security Policies</ns0:value></ns0:attribute>
      <ns0:ref name="id-attr" />
      <ns0:ref name="basic-content-pat" />
      <ns0:zeroOrMore>
        <ns0:ref name="OSPs" />
      </ns0:zeroOrMore>
    </ns0:element>
  </ns0:define>


  <ns0:define name="OSPs">
    <ns0:element name="OSPs">
            <ns1:documentation>
              Grouping for Organizational Security Policies
      </ns1:documentation>

            <ns0:oneOrMore>
              <ns0:element name="OSP">
                <ns0:ref name="id-attr" />
          <ns0:ref name="description" />
          <ns0:oneOrMore>
            <ns0:ref name="objective-refer" />
          </ns0:oneOrMore>
              </ns0:element>
            </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="assumptions">
    <ns0:element name="assumptions">
      <ns1:documentation>
        Grouping of assumptions.
      </ns1:documentation>
      <ns0:zeroOrMore>
        <ns0:element name="assumption">
          <ns1:documentation>
            Describes assumptions made.
          </ns1:documentation>
          <ns0:attribute name="id">
            <ns1:documentation>
              An assumption-wide unique ID that is also displayed to the user.
            </ns1:documentation>
          </ns0:attribute>
          <ns0:ref name="description" />
          <ns0:oneOrMore>
          <ns0:ref name="objective-refer" />
          </ns0:oneOrMore>
        </ns0:element>
      </ns0:zeroOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="Tests">
    <ns0:element name="Tests">
      <ns1:documentation>
        Denotes a tests section.
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="Guidance">
    <ns0:element name="Guidance">
      <ns1:documentation>
        Denotes a Guidance section.
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>
  <ns0:define name="TSS">
    <ns0:element name="TSS">
      <ns1:documentation>
        Denotes a TSS section.
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>
  <ns0:define name="aactivity">
    <ns0:element name="aactivity">
      <ns1:documentation>
Element containing an Assurance Activity. TSS, Guidance, and Tests tags MUST now encapsulate (rather than precede) their content. 
The page at http://commoncriteria.github.io/Encapsulator.html may be helpful.
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
      <ns0:choice>
        <ns0:element name="no-tests"><ns0:empty /></ns0:element>
        <ns0:group>
          <ns0:ref name="TSS" />
          <ns0:optional>
            <ns0:ref name="Guidance" />
          </ns0:optional>
          <ns0:optional>
            <ns0:ref name="Tests" />
          </ns0:optional>
        </ns0:group>
        <ns0:group>
          <ns0:ref name="Guidance" />
          <ns0:optional>
            <ns0:ref name="Tests" />
          </ns0:optional>
        </ns0:group>
        <ns0:group>
            <ns0:ref name="Tests" />
        </ns0:group>
      </ns0:choice>
    </ns0:element>
  </ns0:define>



  <ns0:define name="refinement-type">
    <ns1:documentation>
      Denotes a refinement.
    </ns1:documentation>
    <ns0:element name="refinement">
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>


  <ns0:define name="steplist">
    <ns0:element name="steplist">
      <ns1:documentation>
        Defines a list of steps to perform a test.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:choice>
          <ns0:ref name="basic-content-pat" />
          <ns0:element name="step">
            <ns1:documentation>
              Denotes a single step.
            </ns1:documentation>
            <ns0:oneOrMore>
              <ns0:choice>
                <ns0:ref name="basic-content-pat" />
                <ns0:ref name="steplist" />
              </ns0:choice>
            </ns0:oneOrMore>
          </ns0:element>
        </ns0:choice>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="testlist">
    <ns0:element name="testlist">
      <ns1:documentation>
        Defines a lists of tests to evaluate a requirement.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:choice>
          <ns0:ref name="basic-content-pat" />
          <ns0:element name="test">
            <ns1:documentation>
              Denotes a single test.
            </ns1:documentation>
            <ns0:oneOrMore>
              <ns0:choice>
                <ns0:ref name="basic-content-pat" />
                <ns0:ref name="testlist" />
                <ns0:ref name="steplist" />
              </ns0:choice>
            </ns0:oneOrMore>
          </ns0:element>
        </ns0:choice>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="f-element">
    <ns0:element name="f-element">
      <ns1:documentation>
        Defines a functional requirement.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="id">
          <ns1:documentation>
            A non-viewed unique ID. It has nothing to do with the ID that"s assigned. It can be 
            something like "has-req-1" or "barry".
          </ns1:documentation>
          <ns0:ref name="el-id-spat" />
        </ns0:attribute>
      </ns0:optional>
      <ns0:ref name="f-element-title" />
      <ns0:optional><ns0:ref name="note" /></ns0:optional>
      <ns0:optional><ns0:ref name="aactivity" /></ns0:optional>
    </ns0:element>
  </ns0:define>


  <ns0:define name="f-elements-pat">
    <ns0:zeroOrMore>
      <ns0:ref name="f-element" />
    </ns0:zeroOrMore>
  </ns0:define>


  <ns0:define name="custom-basic-content-pat">
      <ns0:choice>
        <ns0:element name="componentsneeded">
          <ns0:oneOrMore>
            <ns0:element name="componentneeded">
              <ns0:element name="componentid">
                <ns0:data type="string">
                  <ns0:param name="pattern">(F|A)[A-Z]{2}_[A-Z0-9^]{2,5}(_EXT)?\.[0-9]</ns0:param>
                </ns0:data>
              </ns0:element>
              <ns0:element name="notes">
                <ns0:ref name="basic-content-pat" />
              </ns0:element>
            </ns0:element>
          </ns0:oneOrMore>
        </ns0:element>
        <ns0:element name="if-opt-app">
          <ns1:documentation>
Content that only appears if the optional appendices exist.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
        <ns0:element name="indent">
          <ns1:documentation>
Tags that this section should be indented(left) 2em.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
      </ns0:choice>
    </ns0:define>

    <ns0:define name="wsn">
    <ns1:documentation>
      Worksheet notes. Human readable Content that should be included in the worksheet.
      These only make sense in the note elements in the f-elements.
    </ns1:documentation>

    <ns0:element name="wsn">
      <ns0:ref name="basic-content-pat" /> 
    </ns0:element>
  </ns0:define>

  
  <ns0:define name="audit-events">
    <ns0:element name="audit-events">
      <ns0:attribute name="table" />
      <ns0:zeroOrMore><ns0:ref name="depends-pat" /></ns0:zeroOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="equation">
    <ns0:element name="equation">
      <ns1:documentation>Element for mathematical equation.</ns1:documentation>
      <ns0:element name="value">
        <ns1:documentation>MathML text representing the equation. Do not wrap with dollar signs. These will be added.</ns1:documentation>
        <ns0:text /></ns0:element>
      <ns0:element name="label"><ns0:ref name="basic-content-pat" /></ns0:element>
    </ns0:element>
  </ns0:define>

  <ns0:define name="basic-content-pat">
    <ns1:documentation>
      Content that can go anywhere (Although some items are only suitable for title elements).
    </ns1:documentation>
    <ns0:oneOrMore>
      <ns0:choice>
        <ns0:text />
        <ns0:ref name="depends-pat" />
        <ns0:ref name="html-element" />
        <ns0:ref name="linkref" />
        <ns0:ref name="citeCC" />
        <ns0:ref name="cite" />
        <ns0:ref name="secref" />
        <ns0:ref name="testlist" />
        <ns0:ref name="selectables" />
        <ns0:ref name="assignable" />
        <ns0:ref name="appref" />
        <ns0:ref name="abbr-el" />
        <ns0:ref name="audit-events" />
        <ns0:ref name="xref" />
        <ns0:ref name="refinement-type" />
        <ns0:ref name="ctr-ref" />
        <ns0:ref name="ctr" />
        <ns0:ref name="figure" />
        <ns0:ref name="figref" />
        <ns0:ref name="equation" />
        <ns0:ref name="wsn" />
        <ns0:element name="no-link">
           <ns1:documentation>Stops automatic abbreviation, component, and element identification in the children.</ns1:documentation>
            <ns0:ref name="basic-content-pat" />
        </ns0:element>
        <ns0:ref name="custom-basic-content-pat" />
      </ns0:choice>
    </ns0:oneOrMore>
  </ns0:define>

  <ns0:define name="SO">
    <ns0:element name="SO">
      <ns1:documentation>
        Entry for a security objective
      </ns1:documentation>
      <ns0:ref name="id-attr" />
      <ns0:ref name="description" />
      <ns0:element name="addressed-by">
        <ns0:ref name="basic-content-pat" />
      </ns0:element>
    </ns0:element>
  </ns0:define>

  <ns0:define name="SOEs">
    <ns0:element name="SOEs">
      <ns1:documentation>
Grouping for Security Objective for the Operation Environment entries.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:element name="SOE">
             <ns0:ref name="id-attr" />
             <ns0:ref name="description" />
           </ns0:element>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>



  <ns0:define name="SOs">
    <ns0:element name="SOs">
      <ns1:documentation>
        Grouping for Security Objective entries.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:ref name="SO" />
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="note">
    <ns0:element name="note">
      <ns1:documentation>
        Any further instructions associated with the requirement.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="role">
          <ns1:documentation>Indicates who is associated with this role</ns1:documentation>
          <ns0:choice>
            <ns0:value>application</ns0:value><ns0:value>Application</ns0:value>
            <ns0:value>developer</ns0:value><ns0:value>Developer</ns0:value>
          </ns0:choice>
        </ns0:attribute>
      </ns0:optional>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="objective-refer">
    <ns0:element name="objective-refer">
      <ns1:documentation>Element that denotes an objective</ns1:documentation>
      <ns0:attribute name="ref">
        <ns1:documentation>Attribute the references the id of a specific objective.</ns1:documentation>
        <ns0:data type="NCName">
          <ns0:param name="pattern">O(E?)\.[_A-Z]+</ns0:param>
              </ns0:data>
      </ns0:attribute>
      <ns0:element name="rationale">
              <ns1:documentation>Argument as to why the objective applies</ns1:documentation>
              <ns0:ref name="basic-content-pat" />
      </ns0:element>
    </ns0:element>
  </ns0:define>

  <ns0:define name="selectable-group">
    <ns0:ref name="selectable-single" />
    <ns0:oneOrMore>
      <ns0:ref name="selectable-single" />
    </ns0:oneOrMore>
  </ns0:define>

  <ns0:define name="selectable-single">
    <ns0:element name="selectable">
      <ns1:documentation>
        Denotes the start of a selectable in a selectables section.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="exclusive"><ns0:choice><ns0:value>yes</ns0:value></ns0:choice></ns0:attribute>
      </ns0:optional>
      <ns0:optional>
        <ns0:ref name="id-attr" />
      </ns0:optional>
      <ns0:zeroOrMore>
        <ns0:element name="requires">
          <ns1:documentation>
            Denotes a selection-based element that is required should this selection chosen.
          </ns1:documentation>
          <ns0:attribute name="req">
            <ns1:documentation>
              The ID of the required element.
            </ns1:documentation>
          </ns0:attribute>
        </ns0:element>
      </ns0:zeroOrMore>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>


  <ns0:define name="selectables">
    <ns0:element name="selectables">
      <ns1:documentation>
        A grouping of selectable elements.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="onlyone">
          <ns1:documentation>
            Designates that at only one item may be selected.
          </ns1:documentation>
          <ns0:choice><ns0:value>yes</ns0:value></ns0:choice>
        </ns0:attribute>
      </ns0:optional>
      <ns0:optional>
        <ns0:attribute name="linebreak">
          <ns1:documentation>
            Indicates that new lines should be appended to every selectable.
          </ns1:documentation>
          <ns0:choice><ns0:value>yes</ns0:value></ns0:choice>
        </ns0:attribute>
      </ns0:optional>
      <ns0:ref name="selectable-group" />
    </ns0:element>
  </ns0:define>



  <ns0:define name="figref">
    <ns0:element name="figref">
      <ns1:documentation>
        References a figure
      </ns1:documentation>
      <ns0:attribute name="refid">
        <ns1:documentation>
          Contains the ID of the figure being referenced.
        </ns1:documentation>
      </ns0:attribute>
    </ns0:element>
  </ns0:define>

  <ns0:define name="figure">
    <ns0:element name="figure">
      <ns1:documentation>
        Tag allow that inserts a picture.
      </ns1:documentation>
      <ns0:optional>
        <ns0:attribute name="pre">
          <ns1:documentation>
            Text that goes before the counter (e.g. "Figure "). It will be included in every reference. By default it is "Figure ".
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:attribute name="entity">
        <ns1:documentation>
          Path to the image file.
        </ns1:documentation>
      </ns0:attribute>
      <ns0:ref name="id-attr" />
      <ns0:ref name="title-attr" />
      <ns0:optional>
        <ns0:attribute name="max-width" />
      </ns0:optional>
    </ns0:element>
  </ns0:define>

  <ns0:define name="ctr">
    <ns0:element name="ctr">
      <ns0:attribute name="id">
        <ns1:documentation>
          Unique ID for this object.
        </ns1:documentation>
      </ns0:attribute>

      <ns0:attribute name="ctr-type">
        <ns1:documentation>
          References the counter family. If no prefix is given, this value
          plus a space is used as the prefix.
        </ns1:documentation>
      </ns0:attribute>
      <ns0:optional>
        <ns0:attribute name="pre">
          <ns1:documentation>
            Text that goes before the counter (e.g. "Table ").
            If it"s not present, this value is "@ctr-type" + " " 
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="ctr-ref">
    <ns0:element name="ctr-ref">
      <ns1:documentation>
        References a counted object.
      </ns1:documentation>
      <ns0:attribute name="refid">
        <ns1:documentation>
          The unique ID of the object being referenced.
        </ns1:documentation>
      </ns0:attribute>
      <ns0:text />
    </ns0:element>
  </ns0:define>

  <ns0:define name="assignable">
    <ns0:element name="assignable">
      <ns1:documentation>
        Assignment section
      </ns1:documentation>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>


  <ns0:define name="abbr-el">
    <ns0:element name="abbr">
      <ns0:optional>
        <ns0:attribute name="linkend">
          <ns1:documentation>
            Identifies the abbreviation definition (should match the text value of the entry).
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:optional>
        <ns0:attribute name="title">
          <ns1:documentation>
            Full readable definition of the abbreviation.
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:optional>
        <ns0:attribute name="class">
          <ns1:documentation>
            Display class associated with this abbreviation.
          </ns1:documentation>
        </ns0:attribute>
      </ns0:optional>
      <ns0:text />
    </ns0:element>
  </ns0:define>

  <ns0:define name="linkend-attr">
    <ns0:attribute name="linkend">
      <ns1:documentation>References an ID of the referenced item.</ns1:documentation>
      
    </ns0:attribute>
  </ns0:define>

  <ns0:define name="html-element">
    <ns1:documentation>
      Pattern defines the html-element, which is any element in the xhtml namespace.
      They have no knowledge of the CC element, and so cannot have any CC descendants.
    </ns1:documentation>
    <ns0:element ns="http://www.w3.org/1999/xhtml">
      <ns0:anyName>
        <ns0:except>
          <ns0:nsName ns="https://niap-ccevs.org/cc/v1" />
        </ns0:except>
      </ns0:anyName>
      <ns1:documentation>
        Defines all html-elements with an optional number of html attributes and descendants.
      </ns1:documentation>
      <ns0:zeroOrMore>
        <ns0:attribute>
          <ns0:anyName />
        </ns0:attribute>
      </ns0:zeroOrMore>
      <ns0:ref name="basic-content-pat" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="audit-events-pat">
    <ns0:zeroOrMore>
      <ns0:element name="audit-event">
        <ns0:optional><ns0:attribute name="type"><ns0:value>optional</ns0:value></ns0:attribute></ns0:optional>
        <ns0:element name="table">
           <ns1:documentation>
The table where this event will go. The default table name is whatever the parent
SFR status is. If it will go in a commonly known table, use the "known" attribute.
If it will go some other table, set the text content to the table name.
            </ns1:documentation>
            <ns0:choice>
                <ns0:attribute name="known"><ns0:choice>
                        <ns0:value>mandatory</ns0:value>
                        <ns0:value>optional</ns0:value>
                        <ns0:value>objective</ns0:value>
                        <ns0:value>sel-based</ns0:value>
                </ns0:choice></ns0:attribute>
                <ns0:attribute name="other" />
            </ns0:choice>
          </ns0:element>
        <ns0:ref name="description" />
        <ns0:zeroOrMore>
          <ns0:element name="add-info">
            <ns0:ref name="basic-content-pat" />
          </ns0:element>
        </ns0:zeroOrMore>
      </ns0:element>
    </ns0:zeroOrMore>
  </ns0:define>

  <ns0:define name="appref">
    <ns0:element name="appref">
      <ns1:documentation>Cross references an item in the appendex</ns1:documentation>
      <ns0:ref name="linkend-attr" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="xref-content">
      <ns0:choice>
        <ns0:ref name="linkend-attr" />
        <ns0:attribute name="to">
          <ns0:choice>
            <ns0:value>ref-strict-optional</ns0:value>
            <ns0:value>sel-based-reqs</ns0:value>
            <ns0:value>obj-reqs</ns0:value>
            <ns0:value>impl-reqs</ns0:value>
          </ns0:choice>
        </ns0:attribute>
      </ns0:choice>
    </ns0:define>
  <ns0:define name="xref">
    <ns0:element name="xref">
      <ns1:documentation>
        Cross references something 
        <html:ul>
          <html:li>with a title attribute,</html:li> 
          <html:li>with a name attribute, </html:li>
          <html:li>with a term element, or </html:li>
          <html:li>a term element, where its contents(i.e. name) matches the linkend-attr.</html:li>
          <html:li>OR other. See xref-content-pattern for more information</html:li>
        </html:ul>
      </ns1:documentation>
      <ns0:ref name="xref-content" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="secref">
    <ns0:element name="secref">
      <ns1:documentation>References a section (Adds word "section").</ns1:documentation>
      <ns0:ref name="linkend-attr" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="linkref">
    <ns0:element name="linkref">
      <ns1:documentation>Cross references components </ns1:documentation>
      <ns0:ref name="linkend-attr" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="cite">
    <ns0:element name="cite">
      <ns1:documentation>Cites something in the bibliography.</ns1:documentation>
      <ns0:ref name="linkend-attr" />
    </ns0:element>
  </ns0:define>

  <ns0:define name="citeCC">
    <ns0:element name="citeCC">
      <ns1:documentation>Cites the CC documents.</ns1:documentation>
      <ns0:empty />
    </ns0:element>
  </ns0:define>

  <ns0:define name="tech-terms">
      <ns0:element name="tech-terms">
        <ns1:documentation>
Section that defines both technical terms and acronyms.
If it"s only an acronym make sure the text content is empty.
        </ns1:documentation>
        <ns0:zeroOrMore>
          <ns0:element name="term">
            <ns0:attribute name="full" />
            <ns0:optional><ns0:attribute name="abbr" /></ns0:optional>
            <ns0:ref name="basic-content-pat" />
          </ns0:element>
        </ns0:zeroOrMore>
      </ns0:element>
  </ns0:define>

  <ns0:define name="bibliography">
    <ns0:element name="bibliography">
      <ns1:documentation>
        Section to define the items references.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:choice>
          <ns0:element name="cc-entry">
            <ns1:documentation>
              Inserts the Common Criteria documents.
            </ns1:documentation>
            <ns0:empty />
          </ns0:element>

          <ns0:element name="entry">
            <ns1:documentation>
              Groups bibliograph entries.
            </ns1:documentation>
            <ns0:ref name="id-attr" />
            <ns0:element name="tag">
              <ns1:documentation>
                A visible bibliography-wide unique identifier.
              </ns1:documentation>
              <ns0:ref name="basic-content-pat" />
            </ns0:element>
            <ns0:ref name="description" />
          </ns0:element>
          
        </ns0:choice>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="boilerplate-no-attr">
    <ns1:documentation>
      Attribute to stifle boilerplate text from being included in this section.
    </ns1:documentation>
    <ns0:optional>
      <ns0:attribute name="boilerplate">
        <ns0:value>no</ns0:value>
      </ns0:attribute>
    </ns0:optional>
  </ns0:define>

  <ns0:define name="title-attr">
    <ns1:documentation>
      Pattern for title attribute.
    </ns1:documentation>
    <ns0:attribute name="title">
      <ns1:documentation>Header that is visible to the user.</ns1:documentation>
    </ns0:attribute>
  </ns0:define>

  <ns0:include href="Commons.rng">
    <ns0:define name="custom-basic-content-pat">
      <ns0:choice>
        <ns0:element name="componentsneeded">
          <ns0:oneOrMore>
            <ns0:element name="componentneeded">
              <ns0:element name="componentid">
                <ns0:data type="string">
                  <ns0:param name="pattern">(F|A)[A-Z]{2}_[A-Z0-9^]{2,5}(_EXT)?\.[0-9]</ns0:param>
                </ns0:data>
              </ns0:element>
              <ns0:element name="notes">
                <ns0:ref name="basic-content-pat" />
              </ns0:element>
            </ns0:element>
          </ns0:oneOrMore>
        </ns0:element>
        <ns0:element name="if-opt-app">
          <ns1:documentation>
Content that only appears if the optional appendices exist.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
        <ns0:element name="indent">
          <ns1:documentation>
Tags that this section should be indented(left) 2em.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
      </ns0:choice>
    </ns0:define>

    <ns0:define name="xref-content">
      <ns0:choice>
        <ns0:ref name="linkend-attr" />
        <ns0:attribute name="to">
          <ns0:choice>
            <ns0:value>ref-strict-optional</ns0:value>
            <ns0:value>sel-based-reqs</ns0:value>
            <ns0:value>obj-reqs</ns0:value>
            <ns0:value>impl-reqs</ns0:value>
          </ns0:choice>
        </ns0:attribute>
      </ns0:choice>
    </ns0:define>
  </ns0:include>



  <ns0:start>
    <ns0:element name="PP">
      <ns1:documentation>Root element for Protection Profile XML document</ns1:documentation>
        <ns0:attribute name="name">
      <ns1:documentation>
        The title of this document.
      </ns1:documentation>
      </ns0:attribute>
      <ns0:optional>
        <ns0:attribute name="type">
          <ns0:choice><ns0:value>package</ns0:value><ns0:value>pp</ns0:value></ns0:choice>
        </ns0:attribute>
      </ns0:optional>
      <ns0:optional>
        <ns0:attribute name="boilerplate">
        <ns1:documentation>
          Indicates that this document shall use boilerplate sections.
        </ns1:documentation>
        <ns0:value>yes</ns0:value></ns0:attribute>
      </ns0:optional>

      <ns0:element name="PPReference">
        <ns1:documentation>
          A wrapper element for document meta-data.
        </ns1:documentation>

        <ns0:element name="ReferenceTable">
          <ns1:documentation>
            A second wrapper element for document meta-data.
          </ns1:documentation>
          <ns0:element name="PPTitle">
            <ns1:documentation>Title of this document</ns1:documentation>
            <ns0:text />
          </ns0:element>
          <ns0:element name="PPVersion">
            <ns1:documentation>

Version of Common Criteria this document follows.
It should be the version listed in the CCPart1/2/3 files consulted.

            </ns1:documentation>
            <ns0:data type="NMTOKEN" />
          </ns0:element>
          <ns0:element name="PPAuthor">
            <ns1:documentation>
              Organization that developed this PP (e.g. National Information Assurance Partnership)
            </ns1:documentation>
            <ns0:text />
          </ns0:element>
          <ns0:element name="PPPubDate">
            <ns1:documentation>
              Date of publication for this PP.
            </ns1:documentation>
            <ns0:data type="date" />
          </ns0:element>
          <ns0:element name="Keywords">
            <ns1:documentation>
              NOT USED. A list of keywords associated with this document.
            </ns1:documentation>
            <ns0:text />
          </ns0:element>
        </ns0:element>
      </ns0:element>
      <ns0:oneOrMore>
        <ns0:element name="RevisionHistory">
          <ns1:documentation>Documents the major changes to releases.</ns1:documentation>
          <ns0:zeroOrMore>
            <ns0:element name="entry">
              <ns1:documentation>Container for individual revisions.</ns1:documentation>
              <ns0:element name="version">
                <ns1:documentation>Text describing the revision.</ns1:documentation>
                <ns0:text />
              </ns0:element>
              <ns0:element name="date">
                <ns1:documentation>Date of the revision.</ns1:documentation>
                <ns0:data type="date" />
              </ns0:element>
              <ns0:element name="subject">
                <ns1:documentation>Description of the revision.</ns1:documentation>
                <ns0:ref name="basic-content-pat" />
              </ns0:element>
            </ns0:element>
          </ns0:zeroOrMore>
        </ns0:element>
      </ns0:oneOrMore>
      <ns0:optional>
        <ns0:element name="foreword">
          <ns1:documentation>Flexible section for a foreword.</ns1:documentation>
          <ns0:zeroOrMore><ns0:ref name="html-element" /></ns0:zeroOrMore>
        </ns0:element>
      </ns0:optional>
      <ns0:ref name="IntroductionChapter" />
      <ns0:ref name="CClaimsChapter" />
      <ns0:oneOrMore>
        <ns0:element name="chapter">
          <ns1:documentation>Major grouping for the document.</ns1:documentation>
          <ns0:ref name="id-attr" />
          <ns0:ref name="title-attr" />
          <ns0:ref name="boilerplate-no-attr" />
          <ns0:oneOrMore>
            <ns0:choice>
              <ns0:ref name="basic-content-pat" />
              <ns0:ref name="section" />
            </ns0:choice>
          </ns0:oneOrMore>
        </ns0:element>
      </ns0:oneOrMore>
      <ns0:ref name="appendix-pat" />
      <ns0:ref name="implements-pat" />

      
      <ns0:optional>
        <ns0:element name="extra-css">
          <ns0:text />
        </ns0:element>
      </ns0:optional>
    </ns0:element>
  </ns0:start>
  
  <ns0:define name="IntroductionChapter">
      <ns0:element name="chapter">
        <ns0:attribute name="title" />
        <ns0:attribute name="id" />
        <ns0:ref name="boilerplate-no-attr" />
        <ns0:ref name="section" />
        <ns0:ref name="tech-terms" />
        <ns0:oneOrMore>
          <ns0:ref name="section" />
        </ns0:oneOrMore>
        </ns0:element>
  </ns0:define>



  <ns0:define name="appendix-pat">
    <ns1:documentation>
      Pattern for title attribute.
    </ns1:documentation>
    <ns0:oneOrMore>
      <ns0:element name="appendix">
        <ns1:documentation>
          Element that defines an appendix.
        </ns1:documentation>
        <ns0:attribute name="id">
          <ns1:documentation>A document-wide unique string.</ns1:documentation>
          <ns0:data type="NCName" />
        </ns0:attribute>
        <ns0:ref name="title-attr" />
        <ns0:ref name="boilerplate-no-attr" />
        <ns0:oneOrMore><ns0:choice>
            <ns0:ref name="basic-content-pat" />
            <ns0:ref name="section" />
            <ns0:ref name="acronyms" />
            <ns0:ref name="bibliography" />
        </ns0:choice></ns0:oneOrMore>
      </ns0:element>
    </ns0:oneOrMore>
  </ns0:define>

  <ns0:define name="section">
    <ns0:element name="section">
      <ns1:documentation>
        A block smaller than a chapter.
      </ns1:documentation>
      <ns0:ref name="id-attr" />
      <ns0:ref name="title-attr" />
      <ns0:oneOrMore>
        <ns0:choice>
          <ns0:ref name="basic-content-pat" />
          <ns0:element name="InsertSPDCorrespondence">
                  <ns1:documentation>
                    Tags the spot where the table mapping threats
                    to objectives to requirements should go.
                  </ns1:documentation>
            <ns0:empty />
          </ns0:element>
          <ns0:ref name="OSPs" />
          <ns0:element name="SOEs">
            <ns1:documentation>
              Grouping for Security Objectives for the Operational environment.
            </ns1:documentation>
            <ns0:oneOrMore>
              <ns0:element name="SOE">
                <ns1:documentation>
                  Security Objective for the Operational environment.
                </ns1:documentation>
                <ns0:ref name="id-attr" />
                <ns0:ref name="description" />
              </ns0:element>
            </ns0:oneOrMore>
          </ns0:element>
          <ns0:ref name="SOs" />
          <ns0:ref name="assumptions" />
          <ns0:ref name="subsection-pattern" />
          <ns0:element name="threats">
            <ns1:documentation>
              Wrapper element for various threats.
            </ns1:documentation>
            <ns0:oneOrMore>
              <ns0:element name="threat">
                <ns1:documentation>
                  Defines a threat.
                </ns1:documentation>
                <ns0:attribute name="id">
                  <ns0:data type="NCName">
                    <ns0:param name="pattern">T\.[_A-Z0-9]+</ns0:param>
                  </ns0:data>
                </ns0:attribute>
                <ns0:ref name="description" />
                <ns0:oneOrMore>
                  <ns0:ref name="objective-refer" />
                </ns0:oneOrMore>
              </ns0:element>
            </ns0:oneOrMore>
          </ns0:element>
          <ns0:element name="usecases">
            <ns1:documentation>
              Wrapper element for uses cases.
            </ns1:documentation>
            <ns0:oneOrMore>
              <ns0:element name="usecase">
                <ns1:documentation>
                  A referrable section on how the protection profiled item is used.
                </ns1:documentation>
                <ns0:ref name="id-attr" />
                <ns0:ref name="title-attr" />
                <ns0:ref name="description" />
              </ns0:element>
            </ns0:oneOrMore>
          </ns0:element>
        </ns0:choice>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="a-elements">
    <ns0:oneOrMore>
      <ns0:element name="a-element">
        <ns1:documentation>
          Defines a functional requirement.
        </ns1:documentation>
        <ns0:optional>
          <ns0:attribute name="id">
            <ns1:documentation>
              A document-wide unique ID 
            </ns1:documentation>
            <ns0:data type="string">
              <ns0:param name="pattern">[\-a-zA-Z0-9]+</ns0:param>
            </ns0:data>
          </ns0:attribute>
        </ns0:optional>
        <ns0:attribute name="type">
          <ns0:data type="string">
            <ns0:param name="pattern">[DCE]</ns0:param>
          </ns0:data>
        </ns0:attribute>
        <ns0:ref name="f-element-title" />
        <ns0:optional>
          <ns0:ref name="note" />
        </ns0:optional>
        <ns0:optional>
          <ns0:element name="aactivity">
            <ns1:documentation>An Evaluation Activity for that applies to this requirement or possibly all previous requirements in this component.</ns1:documentation>
            <ns0:ref name="basic-content-pat" />
          </ns0:element>
        </ns0:optional>
      </ns0:element>
    </ns0:oneOrMore>
  </ns0:define>

  <ns0:define name="f-component-pattern">
    <ns0:element name="f-component">
      <ns1:document>
        Specifies a component under Security Functional Requirements section..
      </ns1:document>
      <ns0:ref name="f-comp-content-pat" />
      <ns0:choice>
        
        
        <ns0:group>
          <ns0:optional>
            <ns0:attribute name="targetdate">
              <ns1:documentation>
                Target date that the requirements under this component become
                manandory. It only makes sense for _objective_ components.
              </ns1:documentation>
              <ns0:data type="date" />
            </ns0:attribute>
          </ns0:optional>
          <ns0:attribute name="status">
            <ns1:documentation>
              Denotes the status of a requirement.
            </ns1:documentation>
            <ns0:value>objective</ns0:value>
          </ns0:attribute>
        </ns0:group>

        
        <ns0:group>
          <ns0:attribute name="status">
            <ns1:documentation>
              Denotes the status of a requirement.
            </ns1:documentation>
            <ns0:value>sel-based</ns0:value>
          </ns0:attribute>
          <ns0:oneOrMore>
            <ns0:ref name="selection-depends" />
          </ns0:oneOrMore>
        </ns0:group>

        
        <ns0:optional>
          <ns0:attribute name="status">
            <ns1:documentation>
              Denotes the status of a requirement.
            </ns1:documentation>
            <ns0:choice>
              <ns0:value>optional</ns0:value>
            </ns0:choice>
          </ns0:attribute>
        </ns0:optional>
      </ns0:choice>
      <ns0:ref name="depends-pat" />
      <ns0:optional><ns0:ref name="note" /></ns0:optional>
      <ns0:ref name="f-elements-pat" />
      <ns0:ref name="audit-events-pat" />
    </ns0:element>
  </ns0:define> 

  <ns0:define name="subsection-pattern">
    <ns0:element name="subsection">
      <ns1:documentation>
        Lower level of grouping
      </ns1:documentation>
      <ns0:ref name="id-attr" />
      <ns0:ref name="title-attr" />
      <ns0:oneOrMore>
        <ns0:choice>
          <ns0:ref name="glossary-section" />
          <ns0:ref name="subsection-pattern" />
          <ns0:ref name="basic-content-pat" />
          <ns0:ref name="a-component-pattern" />
          <ns0:ref name="f-component-pattern" />
        </ns0:choice>
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>


  <ns0:define name="a-component-pattern">
    <ns0:element name="a-component">
      <ns1:document>
        Specifies a component under Security Assurance Requirements section.
      </ns1:document>
      <ns0:ref name="id-attr" />
      <ns0:attribute name="name">
        <ns1:document>
          A readable title for this component
        </ns1:document>
      </ns0:attribute>
      <ns0:ref name="basic-content-pat" />
      <ns0:optional>
        <ns0:element name="summary">
          <ns1:documentation>
            Summary of this component.
          </ns1:documentation>
          <ns0:ref name="basic-content-pat" />
        </ns0:element>
      </ns0:optional>

      <ns0:oneOrMore>
        <ns0:ref name="a-elements" />
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

  <ns0:define name="glossary-section">
    <ns0:element name="glossary">
      <ns1:documentation>
        Section to define terms.
      </ns1:documentation>
      <ns0:oneOrMore>
        <ns0:ref name="entry-el" />
      </ns0:oneOrMore>
    </ns0:element>
  </ns0:define>

</ns0:grammar>
